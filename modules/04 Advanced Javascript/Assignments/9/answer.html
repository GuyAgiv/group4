<html>
	<head>
		<title>My Album Web Application</title>
		<style>
			body {
				background-color: purple;
			}
			
			.subPic {
				width: 100px;
				height: 100px;
				margin: 10px;
				margin-top:70px;
				
			}
			
			.subPic:hover{
				cursor:pointer;
			}
			
			#container {
				text-align: center;
			}
			#mainPicture 
			{
				margin-top: 40px;
				height: 350px;
				width: 350px;
			}
			
			#mainPictureContainer {
				display:block;
			}
			
			.arrow{
				margin-bottom: 50px;
				width: 200px;
				height: 200px;
				display:inline-block;
			}
			
			.arrow:hover{
				cursor: pointer;
			}
			
			.loader {
			  border: 16px solid #f3f3f3; /* Light grey */
			  border-top: 16px solid #3498db; /* Blue */
			  border-radius: 50%;
			  width: 70px;
			  height: 70px;
			  animation: spin 2s linear infinite;
			}

			@keyframes spin {
			  0% { transform: rotate(0deg); }
			  100% { transform: rotate(360deg); }
			}
			
			
			.picObject {
				display:inline-block;
				height: 100px;
				width: 100px;
				padding: 10px;
			}
			
			.postUrl {
				display:block;
			}

			
		</style>
	</head>
	
	<body>
		<div id="container">
		
			<div id="mainPictureContainer">
				<div id="leftArrowContainer" class="arrow">
					<img class="arrow" src="http://pixsector.com/cache/8ed3eed7/avb6b6c2625bcda563bf1.png" onclick="moveLeft()">
				</div>
			
				<img data-index="0" id="mainPicture" src=#>
				
				<div id="rightArrowContainer" class="arrow">
					<img class="arrow" src="http://pixsector.com/cache/d317f9c9/avefdb1ad8fbf8d8b72a2.png" onclick="moveRight()">
				</div>
			</div>
			
			<div id="subPicturesContainer">
				<div class="picObject">
					<img data-index="0" class="subPic loader" src="#">
					<a class="postUrl" href="" data-index="0"></a>
				</div>
				
				<div class="picObject">
					<img data-index="1" class="subPic loader" src="#">
					<a class="postUrl" href="" data-index="1"></a>
				</div>
				
				<div class="picObject">
					<img data-index="2" class="subPic loader" src="#">
					<a class="postUrl" href="" data-index="2"></a>
				</div>
				
				<div class="picObject">
					<img data-index="3" class="subPic loader" src="#">
					<a class="postUrl" href="" data-index="3"></a>
				</div>
				
				<div class="picObject">
					<img data-index="4" class="subPic loader" src="#">
					<a class="postUrl" href="" data-index="4"></a>
				</div>
				
				<div class="picObject">
					<img data-index="5" class="subPic loader" src="#">
					<a class="postUrl" href="" data-index="5"></a>
				</div>
				
				<div class="picObject">
					<img data-index="6" class="subPic loader" src="#">
					<a class="postUrl" href="" data-index="6"></a>
				</div>
				
				<div class="picObject">
					<img data-index="7" class="subPic loader" src="#">
					<a class="postUrl" href="" data-index="7"></a>
				</div>
				
				<div class="picObject">
					<img data-index="8" class="subPic loader" src="#">
					<a class="postUrl" href="" data-index="8"></a>
				</div>
				
				<div class="picObject">
					<img data-index="9" class="subPic loader" src="#">
					<a class="postUrl" href="" data-index="9"></a>
				</div>
				
			</div>
		</div>	
		<script>
		
			var picturesArr = [];
			const maxIndex = 9;
			const minIndex = 0;
			
			
			var currentPicture = document.querySelector("#mainPicture");
			
			function onStart()
			{
				var spc = document.querySelectorAll(".subPic");
				generateRandomPictures();
				
				var pic1 = new Picture();
				var pic2 = new Picture();
				var pic3 = new Picture();
				var pic4 = new Picture();
				var pic5 = new Picture();
				var pic6 = new Picture();
				var pic7 = new Picture();
				var pic8 = new Picture();
				var pic9 = new Picture();
				var pic10 = new Picture();
				
				picturesArr.push(pic1);
				picturesArr.push(pic2);			
				picturesArr.push(pic3);
				picturesArr.push(pic4);
				picturesArr.push(pic5);			
				picturesArr.push(pic6);
				picturesArr.push(pic7);
				picturesArr.push(pic8);			
				picturesArr.push(pic9);		
				picturesArr.push(pic10);
				
				for(var i = 0; i < spc.length; i++)
				{
					picturesArr[i].src = spc[i].src;
					spc[i].onclick = function(){
						mainPicture.src = this.src;
						mainPicture.setAttribute("data-index", this.getAttribute("data-index"));
						
						saveMainPic();
					}
				}
				
				var mainPicFromMemory = localStorage.getItem("mainPic");
				
				if(mainPicFromMemory)
				{
					mainPicture.src = mainPicFromMemory;
					mainPicture.setAttribute("data-index", localStorage.getItem("picIndex"));
				}
				else
				{
					currentPicture.src = picturesArr[0].src;
				}
			}
			
			function moveLeft()
			{
				var currentPictureIndex = Number(currentPicture.getAttribute("data-index"));
				
				if(currentPictureIndex > minIndex)
				{	
					var prevIndex = currentPictureIndex - 1;
					var prevPic = document.querySelector('.subPic[data-index = "' + prevIndex + '"]');
					currentPicture.setAttribute("data-index", prevIndex);
					currentPicture.src = prevPic.src;
					saveMainPic();
				}
			}
			
			function moveRight()
			{
				
				var currentPictureIndex = Number(currentPicture.getAttribute("data-index"));
				
				if(currentPictureIndex < maxIndex)
				{
					var nextIndex = currentPictureIndex + 1;
					var nextPic = document.querySelector('.subPic[data-index = "' + nextIndex + '"]');
					currentPicture.setAttribute("data-index", nextIndex);
					currentPicture.src = nextPic.src;
					saveMainPic();
				}
			}
			function Picture(src)
			{
				this.src = src;
			}
			
			function saveMainPic()
			{
				localStorage.setItem("mainPic", mainPicture.src);
				localStorage.setItem("picIndex", mainPicture.getAttribute("data-index"));
			}
			
			function generateRandomPictures()
			{
				fetch("https://picsum.photos/list").then( (stream) =>
				{
					stream.json().then(function(json){
						var subPics = document.querySelectorAll(".subPic");
						var myPics = json;
						var picInstance = Math.floor(Math.random() * 994);
						var aRef = document.querySelectorAll(".postUrl");
						for(var i = 0; i < subPics.length; ++i)
						{	subPics[i].onload = function() {
								this.classList.toggle("loader");
							}
							picInstance = Math.floor(Math.random() * 990);
							subPics[i].src = "https://picsum.photos/200/300?image=" + myPics[picInstance].id;

							aRef[i].href = myPics[picInstance].post_url;
							aRef[i].innerText = "Link to original post"
						}

					})
				}).catch();
			}
			
			
			onStart();
		</script>
	</body>
</html>
